Various validation functions
====================
Collected and revised by Johan Lingvall.